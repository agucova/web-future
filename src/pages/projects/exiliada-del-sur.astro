---
// Standalone page - minimal entry point with image optimization
import { getImage } from "astro:assets";
import ExiliadaDelSur from "../../components/exiliada/ExiliadaDelSur.svelte";
import "../../styles/exiliada.css";

// Import all place images
import losLagosImg from "../../assets/exiliada-del-sur/places/los-lagos.jpg";
import parralImg from "../../assets/exiliada-del-sur/places/parral.jpg";
import buinImg from "../../assets/exiliada-del-sur/places/buin.jpg";
import sanVicenteImg from "../../assets/exiliada-del-sur/places/san-vicente.jpg";
import curacautinImg from "../../assets/exiliada-del-sur/places/curacautin.jpg";
import maitencilloImg from "../../assets/exiliada-del-sur/places/maitencillo.jpg";
import pelequenImg from "../../assets/exiliada-del-sur/places/pelequen.jpg";
import perquilauquenImg from "../../assets/exiliada-del-sur/places/perquilauquen.jpg";
import sanRosendoImg from "../../assets/exiliada-del-sur/places/san-rosendo.jpg";
import quiriquinaImg from "../../assets/exiliada-del-sur/places/quiriquina.jpg";
import temucoImg from "../../assets/exiliada-del-sur/places/temuco.jpg";
import calbucoImg from "../../assets/exiliada-del-sur/places/calbuco.jpg";
import chacabucoImg from "../../assets/exiliada-del-sur/places/chacabuco.jpg";
import granerosImg from "../../assets/exiliada-del-sur/places/graneros.jpg";
import sanSebastianImg from "../../assets/exiliada-del-sur/places/san-sebastian.jpg";
import chillanImg from "../../assets/exiliada-del-sur/places/chillan.jpg";
import cabreroImg from "../../assets/exiliada-del-sur/places/cabrero.jpg";
import itataImg from "../../assets/exiliada-del-sur/places/itata.jpg";
import nacimientoImg from "../../assets/exiliada-del-sur/places/nacimiento.jpg";
import rinihueImg from "../../assets/exiliada-del-sur/places/rinihue.jpg";

// Import word images
import chiriqueImg from "../../assets/exiliada-del-sur/words/chirique.jpg";
import coligueImg from "../../assets/exiliada-del-sur/words/coligue.jpg";

// Generate optimized images (webp, sized for display)
const optimizedImages = {
    "los-lagos": await getImage({
        src: losLagosImg,
        width: 400,
        format: "webp",
    }),
    parral: await getImage({ src: parralImg, width: 400, format: "webp" }),
    buin: await getImage({ src: buinImg, width: 400, format: "webp" }),
    "san-vicente": await getImage({
        src: sanVicenteImg,
        width: 400,
        format: "webp",
    }),
    curacautin: await getImage({
        src: curacautinImg,
        width: 400,
        format: "webp",
    }),
    maitencillo: await getImage({
        src: maitencilloImg,
        width: 400,
        format: "webp",
    }),
    pelequen: await getImage({ src: pelequenImg, width: 400, format: "webp" }),
    perquilauquen: await getImage({
        src: perquilauquenImg,
        width: 400,
        format: "webp",
    }),
    "san-rosendo": await getImage({
        src: sanRosendoImg,
        width: 400,
        format: "webp",
    }),
    quiriquina: await getImage({
        src: quiriquinaImg,
        width: 400,
        format: "webp",
    }),
    temuco: await getImage({ src: temucoImg, width: 400, format: "webp" }),
    calbuco: await getImage({ src: calbucoImg, width: 400, format: "webp" }),
    chacabuco: await getImage({
        src: chacabucoImg,
        width: 400,
        format: "webp",
    }),
    graneros: await getImage({ src: granerosImg, width: 400, format: "webp" }),
    "san-sebastian": await getImage({
        src: sanSebastianImg,
        width: 400,
        format: "webp",
    }),
    chillan: await getImage({ src: chillanImg, width: 400, format: "webp" }),
    cabrero: await getImage({ src: cabreroImg, width: 400, format: "webp" }),
    itata: await getImage({ src: itataImg, width: 400, format: "webp" }),
    nacimiento: await getImage({
        src: nacimientoImg,
        width: 400,
        format: "webp",
    }),
    rinihue: await getImage({ src: rinihueImg, width: 400, format: "webp" }),
    "rinihue-2": await getImage({ src: rinihueImg, width: 400, format: "webp" }),
    "rinihue-3": await getImage({ src: rinihueImg, width: 400, format: "webp" }),
};

// Generate large images for lightbox view (1200px width)
const optimizedImagesLarge = {
    "los-lagos": await getImage({ src: losLagosImg, width: 1200, format: "webp" }),
    parral: await getImage({ src: parralImg, width: 1200, format: "webp" }),
    buin: await getImage({ src: buinImg, width: 1200, format: "webp" }),
    "san-vicente": await getImage({ src: sanVicenteImg, width: 1200, format: "webp" }),
    curacautin: await getImage({ src: curacautinImg, width: 1200, format: "webp" }),
    maitencillo: await getImage({ src: maitencilloImg, width: 1200, format: "webp" }),
    pelequen: await getImage({ src: pelequenImg, width: 1200, format: "webp" }),
    perquilauquen: await getImage({ src: perquilauquenImg, width: 1200, format: "webp" }),
    "san-rosendo": await getImage({ src: sanRosendoImg, width: 1200, format: "webp" }),
    quiriquina: await getImage({ src: quiriquinaImg, width: 1200, format: "webp" }),
    temuco: await getImage({ src: temucoImg, width: 1200, format: "webp" }),
    calbuco: await getImage({ src: calbucoImg, width: 1200, format: "webp" }),
    chacabuco: await getImage({ src: chacabucoImg, width: 1200, format: "webp" }),
    graneros: await getImage({ src: granerosImg, width: 1200, format: "webp" }),
    "san-sebastian": await getImage({ src: sanSebastianImg, width: 1200, format: "webp" }),
    chillan: await getImage({ src: chillanImg, width: 1200, format: "webp" }),
    cabrero: await getImage({ src: cabreroImg, width: 1200, format: "webp" }),
    itata: await getImage({ src: itataImg, width: 1200, format: "webp" }),
    nacimiento: await getImage({ src: nacimientoImg, width: 1200, format: "webp" }),
    rinihue: await getImage({ src: rinihueImg, width: 1200, format: "webp" }),
    "rinihue-2": await getImage({ src: rinihueImg, width: 1200, format: "webp" }),
    "rinihue-3": await getImage({ src: rinihueImg, width: 1200, format: "webp" }),
};

// Generate optimized word images (larger for mobile drawer display)
const optimizedWordImages = {
    chirigues: await getImage({ src: chiriqueImg, width: 600, format: "webp" }),
    coligue: await getImage({ src: coligueImg, width: 600, format: "webp" }),
};

// Create a map of place keys to optimized image URLs for the Svelte component
const imageUrls = Object.fromEntries(
    Object.entries(optimizedImages).map(([key, img]) => [key, img.src]),
);

// Create a map of place keys to large image URLs for lightbox
const imageUrlsLarge = Object.fromEntries(
    Object.entries(optimizedImagesLarge).map(([key, img]) => [key, img.src]),
);

// Create a map of word keys to optimized image URLs
const wordImageUrls = Object.fromEntries(
    Object.entries(optimizedWordImages).map(([key, img]) => [key, img.src]),
);
---

<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Exiliada del Sur — Violeta Parra</title>
        <link rel="icon" type="image/svg+xml" href="/exiliada-del-sur/favicon-pin.svg" />

        <!-- Meta tags for social sharing -->
        <meta name="description" content="Una visualización interactiva de 'La Exiliada del Sur' de Violeta Parra, interpretada por Inti Illimani. Explora el recorrido a través del sur de Chile." />

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://agucova.dev/projects/exiliada-del-sur" />
        <meta property="og:title" content="La Exiliada del Sur — Violeta Parra" />
        <meta property="og:description" content="Una visualización interactiva del poema de Violeta Parra, interpretada por Inti Illimani. Explora el recorrido a través del sur de Chile." />
        <meta property="og:image" content="https://agucova.dev/exiliada-del-sur/og-image.jpg" />

        <!-- Twitter -->
        <meta property="twitter:card" content="summary_large_image" />
        <meta property="twitter:url" content="https://agucova.dev/projects/exiliada-del-sur" />
        <meta property="twitter:title" content="La Exiliada del Sur — Violeta Parra" />
        <meta property="twitter:description" content="Una visualización interactiva del poema de Violeta Parra, interpretada por Inti Illimani. Explora el recorrido a través del sur de Chile." />
        <meta property="twitter:image" content="https://agucova.dev/exiliada-del-sur/og-image.jpg" />

        <!-- Preload first two images (los-lagos and parral appear first in the song) -->
        <link
            rel="preload"
            as="image"
            href={optimizedImages["los-lagos"].src}
        />
        <link rel="preload" as="image" href={optimizedImages["parral"].src} />

        <!-- Google Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;1,400;1,500&family=Source+Serif+4:ital,opsz,wght@0,8..60,400;0,8..60,600;1,8..60,400&display=swap"
            rel="stylesheet"
        />
    </head>
    <body>
        <ExiliadaDelSur client:load imageUrls={imageUrls} imageUrlsLarge={imageUrlsLarge} wordImageUrls={wordImageUrls} />
    </body>
</html>
